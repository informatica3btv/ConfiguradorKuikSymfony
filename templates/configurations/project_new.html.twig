{% extends 'layout.html.twig' %}

{% block page_title %}Crear proyecto{% endblock %}

{% block stylesheets %}
  {{ parent() }}
  <style>
    :root{
      --bg:#f6f9fc;
      --ink:#0b1220;
      --muted:#6b7280;
      --line: rgba(15,23,42,.12);
      --card:#fff;
      --shadow: 0 10px 25px rgba(2,20,60,.10);
      --shadow-sm: 0 6px 14px rgba(2,20,60,.08);
      --blue:#0b76d8;
    }

    .wrap{
      max-width: 980px;
      margin: 26px auto 70px;
      padding: 0 14px;
    }

    .page-title{
      font-size:34px;
      font-weight:900;
      letter-spacing:-.02em;
      margin:0;
    }

    .page-sub{
      color:var(--muted);
      margin-top:6px;
      font-size:16px;
    }

    .card{
      margin-top:18px;
      background:var(--card);
      border:1px solid var(--line);
      border-radius:20px;
      padding:24px;
      box-shadow: var(--shadow);
    }

    .grid{
      display:grid;
      grid-template-columns: repeat(2, 1fr);
      gap:16px;
    }

    .field label{
      display:block;
      font-weight:800;
      margin-bottom:6px;
      font-size:14px;
    }

    .field input{
      width:100%;
      padding:14px 16px;
      border-radius:14px;
      border:1px solid rgba(15,23,42,.14);
      background:#fff;
      outline:none;
      transition:.15s;
      font-size:15px;
    }

    .field input:focus{
      border-color:var(--blue);
      box-shadow:0 0 0 4px rgba(11,118,216,.15);
    }

    .primary-btn{
      padding:14px 26px;
      border-radius:999px;
      border:0;
      background:linear-gradient(135deg,#0b76d8,#1187e6);
      color:#fff;
      font-weight:900;
      cursor:pointer;
      box-shadow:0 10px 20px rgba(17,135,230,.25);
      transition:.15s;
      white-space:nowrap;
      font-size:15px;
    }
    .primary-btn:hover{ transform:translateY(-1px); }

    .warn{
      color:#b91c1c;
      font-weight:800;
      font-size:14px;
    }

    @media (max-width: 720px){
      .grid{ grid-template-columns: 1fr; }
    }
  </style>
{% endblock %}

{% block content %}
<div class="wrap">

  <div>
    <div class="page-title">Crear proyecto</div>
    <div class="page-sub">Introduce los datos del cliente y del proyecto</div>
  </div>

  <form method="post"
        action="{{ path('configuration_project_create') }}"
        id="projectForm"
        novalidate>

    <input type="hidden" name="config_id" value="{{ config_id ?? '' }}">

    <div class="card">
      <div class="grid">

        <div class="field">
          <label for="project_name">Nombre del proyecto *</label>
          <input id="project_name" name="project_name" type="text"
                 placeholder="Ej. Proyecto Madrid 01" required>
        </div>

        <div class="field">
          <label for="client_name">Nombre del cliente *</label>
          <input id="client_name" name="client_name" type="text"
                 placeholder="Ej. Juan Pérez" required>
        </div>

        <div class="field">
          <label for="phone">Teléfono</label>
          <input id="phone" name="phone" type="tel"
                 placeholder="Ej. 600 123 456">
        </div>

        <div class="field">
          <label for="email">Correo</label>
          <input id="email" name="email" type="email"
                 placeholder="Ej. cliente@correo.com">
        </div>

        <div class="field">
          <label for="city">Ciudad</label>
          <input id="city" name="city" type="text"
                 placeholder="Ej. Madrid">
        </div>

        <div class="field">
          <label for="address">Dirección</label>
          <input id="address" name="address" type="text"
                 placeholder="Ej. Calle Mayor 10">
        </div>

      </div>

      <div style="margin-top:22px; display:flex; gap:12px; align-items:center;">
        <button type="submit" class="primary-btn">
          Crear y continuar
        </button>
        <div id="projectError" class="warn"></div>
      </div>
    </div>
  </form>
</div>
{% endblock %}

{% block javascripts %}
{{ parent() }}
<script>
document.addEventListener('DOMContentLoaded', () => {
  const form = document.getElementById('projectForm');
  const err = document.getElementById('projectError');

  const requiredIds = ['project_name', 'client_name'];

  form.addEventListener('submit', (e) => {
    err.textContent = '';

    const missing = requiredIds.filter(id => {
      const el = document.getElementById(id);
      return !el.value || !el.value.trim();
    });

    if (missing.length) {
      e.preventDefault();
      err.textContent = 'Rellena los campos obligatorios (*) para continuar.';
      document.getElementById(missing[0]).focus();
      return;
    }

    const email = document.getElementById('email').value.trim();
    if (email && !/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) {
      e.preventDefault();
      err.textContent = 'El correo no tiene un formato válido.';
      document.getElementById('email').focus();
    }
  });
});
</script>
{% endblock %}
